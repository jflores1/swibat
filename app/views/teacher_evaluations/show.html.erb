<%= provide(:title, "#{@evaluation.eval_type.capitalize} for #{@user.full_name}") %>


<% content_for :left_column do %>
	<h1><%= @evaluation.eval_type.capitalize %> for <%= link_to @user.full_name, user_path(@user) %></h1>
	<p>Published on <%= normal_date_format(@evaluation.created_at) %></p>
	
	<% if @evaluation.eval_type == "observation" %>
		<% if @evaluation.video %>						
				<div class="summary-graph video">
					<iframe width="100%" height="400px" src="http://www.youtube.com/embed/<%= @evaluation.video.yt_video_id %>" frameborder="0" allowfullscreen></iframe>
				</div>
		<% end %>	
	<% end %>

	<h3>Total Score: <%= number_with_precision(@evaluation.calculate_score, :precision => 2) %></h3>

	<h3>Score by domain</h3>

	<table class="table table-striped table-bordered">
		<thead>
			<tr>
				<th width="50%"></th>
				<th class="eval">Unsatisfactory</th>
				<th class="eval">Basic</th>
				<th class="eval">Proficient</th>
				<th class="eval">Distinguished</th>
			</tr>
		</thead>
		<tbody>			
			<% @evaluation.evaluation_template.evaluation_domains.each do |domain| %>
				<tr class="domain-row">
					<td class="domain" colspan="5"><%= domain.name %> (Score: <%= number_with_precision(domain.calculate_score(@evaluation), :precision => 2)%>)</td>
				</tr>

				<% domain.evaluation_criteria.each do |criterion| %>
					<tr class="subdomain-row">
						<td class="subdomain"><%= criterion.contents %></td>
						<% rating = EvaluationRating.find_by_criterion_id_and_evaluation_id(criterion.id, @evaluation.id) %>
						<% (1..4).each do |i| %>
							<td class="eval">
								<%= '<i class="icon icon-ok"></i>'.html_safe if rating && rating.score == i %>
							</td>
						<% end %>
					</tr>
				<% end %>
			<% end %>
		</tbody>
	</table>

	<div>
	  <header>
	    <h2>Comments</h2>
	  </header>
	  <section class="course-info">
	    <%= render :partial => 'comments/comments', :locals => {:commentable => @evaluation} %>
	  </section>
	</div>

<% end %>

<% content_for :right_column do %>
	<%= render partial: 'sidebar' %>
<% end %>
